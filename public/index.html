<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Real Estate</title>
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/site.webmanifest">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css"
        integrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA=="
        crossorigin="anonymous" referrerpolicy="no-referrer" />
        <link rel="stylesheet" href="style2.css">
</head>

<body>
    <nav>
        <div class="index-navbar">
            <div class="typewriter">
                <h1>ICONIC RE real estates</h1>
            </div>
            <ul>
                <li><a href="index.html">Home</a></li>
                <li><a href="about.html">About</a></li>
                <li><a href="contact.html">Contact us</a></li>
                <li><a href="signup.html">Signup/login</a></li>
                <li id="dashboardLink" style="display: none;"><a href="dashboard.html">Dashboard</a></li>
                </li>

            </ul>
        </div>
    </nav>

    <hero>
        <div class="index-hero"></div>
    </hero>
    <section>
        <div class="index-section">
            <div class="index-s1">
                <h1>ICONIC RE <sub>Real Estates</sub></h1>
                <p>
                    Lorem ipsum dolor sit amet consectetur, adipisicing elit. Non ex nam rem sequi, repudiandae aut unde
                    tempore numquam fugit laboriosam. Rerum placeat dicta repudiandae voluptatibus! Minus optio sapiente
                    rem ullam.
                    Quia doloremque delectus maiores animi dolor expedita deleniti adipisci, dicta libero at, blanditiis
                    voluptatum accusamus molestias laborum nisi illum sint iste facere mollitia. Nostrum esse hic amet
                    ipsa impedit consectetur.
                    Nemo magnam totam id fuga aperiam dolorum sapiente eum suscipit culpa, provident consequatur dolor
                    ab amet odio non sint et vitae doloribus. Alias tenetur, asperiores ab fugiat eum ex totam.
                    Earum architecto, natus officiis recusandae dolore unde assumenda veritatis eius temporibus nihil
                    aliquam eligendi error suscipit blanditiis quasi quis enim quaerat iure veniam. Aut cupiditate qui
                    ullam quos delectus sequi?
                    Est voluptates nisi quod reprehenderit commodi temporibus voluptate recusandae at animi velit
                    adipisci accusamus, tempore esse, suscipit enim modi in? Voluptates, ut. Facilis nisi exercitationem
                    ratione reiciendis error necessitatibus nulla!
                    Ea sit distinctio perferendis porro. Quis culpa suscipit delectus dolore id autem quisquam eligendi
                    recusandae asperiores perferendis deleniti, molestiae ea natus doloribus quae vel laudantium. Neque
                    tempora aperiam ipsa ratione.

                </p>
            </div>
            <div class="index-s2">
                <h1>OUR LOCATION</h1>
                <iframe
                    src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d15228.147014975779!2d73.5242414479908!3d17.410023735693603!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x3bc2010d5dc98c77%3A0x6846fce8a7fd1002!2sSawarde%2C%20Maharashtra%20415606!5e0!3m2!1sen!2sin!4v1704000934846!5m2!1sen!2sin"
                    width="25%" height="40%" style="border:0;" allowfullscreen="" loading="lazy"
                    referrerpolicy="no-referrer-when-downgrade"></iframe>
            </div>
        </div>
    </section>
    <property>
        <div>
            <h1>FEATURED PROPERTIES</h1>
            <div class="search-bar">
                <input type="text" id="locationSearch" placeholder="Search by location">
                <button onclick="searchProperties()"><i class="fa-solid fa-search"></i></button>
            </div>
        </div>
        <div class="property" id="propertyContainer">
            <!-- Property listings will be dynamically added here using JavaScript -->
        </div>
    </property>
    <footer>
        <div class="footer">
            <div class="footer-left">

                <h3>ICONIC RE<span>real estates</span></h3>

                <p class="footer-links">
                    <a href="index.html" class="link-1">Home</a>

                    <a href="signup.html">login/signup</a>

                    <a href="dashboard.html">Dashboard</a>

                    <a href="about.html">About</a>

                    <a href="contact.html">Contact</a>
                </p>

                <p class="footer-company-name">ICONIC RE Â© 2015</p>
            </div>

            <div class="footer-center">

                <div>
                    <i class="fa-solid fa-location-dot"></i>
                    <p><span>Maharashtra</span>india</p>
                </div>

                <div>
                    <i class="fa-solid fa-mobile-screen-button"></i>
                    <p>+91 9678054483</p>
                </div>

                <div>
                    <i class="fa fa-envelope"></i>
                    <p><a href="mailto:sohamlkhanvilkar@gmail.com">support@company.com</a></p>
                </div>

            </div>

            <div class="footer-right">

                <p class="footer-company-about">
                    <span>About the company</span>
                    Lorem ipsum dolor sit amet, consectateur adispicing elit. Fusce euismod convallis velit, eu auctor
                    lacus vehicula sit amet.
                </p>

                <div class="footer-icons">

                    <a href="https://www.facebook.com/"><i class="fa-brands fa-facebook"></i></a>
                    <a href="https://www.twitter.com"><i class="fa-brands fa-twitter"></i></a>
                    <a href="https://www.linkdin.com"><i class="fa-brands fa-linkedin"></i></a>
                    <a href="https://www.github.com"><i class="fa-brands fa-github"></i></a>

                </div>

            </div>


        </div>
    </footer>
    <div id="propertyPopup" class="popup">
        <div class="popup-content">
            <span class="close" onclick="closePopup()">&times;</span>
            <h2 id="popupTitle">Property Details</h2>
            <img id="popupImage" src="/uploads/${property.propertyImage}" alt="Property Image" style="max-width: 100%">
            <p id="popupLocation" class="property-location">Location: </p>
            <p id="popupPrice" class="property-price">Price: $</p>
            <p id="popupphoneNo">Phone No:+91</p>
            <button id="contactButton" onclick="contactOwner()" class="contact-button">Mail Owner</button>

        </div>
    </div>



    <script>
        async function fetchAndDisplayProperties() {
            try {
                const response = await fetch('/api/getProperties');
                const properties = await response.json();

                const propertyContainer = document.getElementById('propertyContainer');
                propertyContainer.innerHTML = '';

                properties.forEach(property => {
                    const propertyCard = document.createElement('div');
                    propertyCard.className = 'property-card';
                    propertyCard.innerHTML = `
          <h3>${property.propertyName}</h3>
          <img src="/uploads/${property.propertyImage}" alt="Property Image" style="max-width: 100%">
          <p>Price: $${property.propertyPrice}</p>
          <p>Location: ${property.propertyLocation}</p>
          <p> Owner phone No: ${property.phoneNo}</p>
        `;

                    propertyCard.addEventListener('click', () => openPopup(property));
                    propertyContainer.appendChild(propertyCard);
                });
            } catch (error) {
                console.error('Error fetching properties:', error);
            }
        }

        function openPopup(property) {
            const popup = document.getElementById('propertyPopup');
            const title = document.getElementById('popupTitle');
            const image = document.getElementById('popupImage');
            const price = document.getElementById('popupPrice');
            const location = document.getElementById('popupLocation');
            const phone = document.getElementById('popupphoneNo');

            const contactButton = document.getElementById('contactButton'); // Add this line

            title.textContent = property.propertyName;
            image.src = `/uploads/${property.propertyImage}`;
            price.textContent = `Price: $${property.propertyPrice}`;
            location.textContent = `Location: ${property.propertyLocation}`;
            phone.textContent = ` Owner phone no: ${property.phoneNo}`;
            contactButton.setAttribute('data-owner-email', property.ownerEmail);

            popup.style.display = 'block';
        }


        function closePopup() {
            const popup = document.getElementById('propertyPopup');
            popup.style.display = 'none';
        }

        window.onload = function () {
            fetchAndDisplayProperties();

            // Add event listener to refresh properties after deletion
            window.addEventListener('propertyDeleted', fetchAndDisplayProperties);
        };
        // sidebar js

        function contactOwner() {
            const contactButton = document.getElementById('contactButton');
            const ownerEmail = contactButton.getAttribute('data-owner-email');
            const subject = 'Regarding Your Property';
            const body = 'I am interested in your property.';

            // Use 'mailto:' to open the default mail app with pre-filled fields
            window.location.href = `mailto:${ownerEmail}?subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(body)}`;
        }

        // js for search functionality

        async function searchProperties() {
    try {
        const searchInput = document.getElementById('locationSearch').value.toLowerCase();
        const propertyContainer = document.getElementById('propertyContainer');

        if (searchInput.trim() === '') {
            // If search bar is empty, fetch and display all properties
            await fetchAndDisplayProperties();
        } else {
            const response = await fetch('/api/getProperties');
            const properties = await response.json();

            const filteredProperties = properties.filter(property =>
                property.propertyLocation.toLowerCase().includes(searchInput)
            );

            propertyContainer.innerHTML = '';

            filteredProperties.forEach(property => {
                const propertyCard = document.createElement('div');
                propertyCard.className = 'property-card';
                propertyCard.innerHTML = `
                    <h3>${property.propertyName}</h3>
                    <img src="/uploads/${property.propertyImage}" alt="Property Image" style="max-width: 100%">
                    <p>Price: $${property.propertyPrice}</p>
                    <p>Location: ${property.propertyLocation}</p>
                    <p>phone: ${property.phoneNo}</p>
                `;

                propertyCard.addEventListener('click', () => openPopup(property));
                propertyContainer.appendChild(propertyCard);
            });
        }
    } catch (error) {
        console.error('Error searching properties:', error);
    }
}

fetch('/check-login')
    .then(response => {
        if (response.status === 200) {
            // User is logged in, show the dashboard link
            const dashboardLink = document.getElementById('dashboardLink');
            dashboardLink.style.display = 'block';
        } else if (response.status === 401) {
            // User is not logged in, hide the dashboard link
            const dashboardLink = document.getElementById('dashboardLink');
            dashboardLink.style.display = 'none';
        }
    })


    </script>
</body>

</html>